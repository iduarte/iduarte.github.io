<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Can you explain to a child what a gene is?">

<title>So, what is a gene? – Isabel Duarte</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../pics/favicon_iduarte.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-91903e51b979062d4d184304d30a9be9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Isabel Duarte</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-science" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Science</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-science">    
        <li>
    <a class="dropdown-item" href="../../my_science.html">
 <span class="dropdown-text">My Science</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../my_lab.html">
 <span class="dropdown-text">My Lab</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../my_cv.html">
 <span class="dropdown-text">My CV</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../my_projects.html">
 <span class="dropdown-text">My Projects</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../my_training.html">
 <span class="dropdown-text">My Training</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../smart.html">
 <span class="dropdown-text">Open Science</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-classes" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Classes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-classes">    
        <li>
    <a class="dropdown-item" href="../../my_classes.html">
 <span class="dropdown-text">Classes</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../my_outreach.html"> 
<span class="menu-text">Outreach</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../the_bioLogical_footnote_blog.html"> 
<span class="menu-text">The BioLogical Footnote</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-more" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">More</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-more">    
        <li>
    <a class="dropdown-item" href="../../my_hobbies.html">
 <span class="dropdown-text">My Hobbies</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../my_contact.html">
 <span class="dropdown-text">Contact me</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-house-heart-fill"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.pattern.institute/">
            Pattern Institute
            </a>
          </li>
      </ul>
    </div>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">So, what <em>is</em> a gene?</h1>
                  <div>
        <div class="description">
          Can you explain to a child what a gene is?
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Gene</div>
                <div class="quarto-category">Biology</div>
                <div class="quarto-category">Phylosophy of science</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#tldr" id="toc-tldr" class="nav-link active" data-scroll-target="#tldr"><strong>TL;DR</strong></a></li>
  <li><a href="#the-full-story" id="toc-the-full-story" class="nav-link" data-scroll-target="#the-full-story">The Full Story</a></li>
  <li><a href="#the-biological-footnote" id="toc-the-biological-footnote" class="nav-link" data-scroll-target="#the-biological-footnote">The BioLogical Footnote</a></li>
  <li><a href="#to-explore-further" id="toc-to-explore-further" class="nav-link" data-scroll-target="#to-explore-further">To Explore Further</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p><img src="gene_image.jpg" class="img-fluid"></p>
<p><br></p>
<section id="tldr" class="level2">
<h2 class="anchored" data-anchor-id="tldr"><strong>TL;DR</strong></h2>
<p>A gene is not a fixed thing with a single definition. It started as an abstract idea used to explain inheritance patterns, later became a stretch of DNA linked to proteins, and is now understood as a flexible, context-dependent set of genomic resources. Despite decades of new biology revealing layers of complexity - regulation, splicing, epigenetics, networks - the gene persists because it adapts. Its power lies not in being precise, but in being useful: a concept that evolves with biology itself.</p>
</section>
<section id="the-full-story" class="level2">
<h2 class="anchored" data-anchor-id="the-full-story">The Full Story</h2>
<section id="what-is-a-gene-a-concept-that-refuses-to-stand-still" class="level4">
<h4 class="anchored" data-anchor-id="what-is-a-gene-a-concept-that-refuses-to-stand-still">What Is a Gene? A Concept That Refuses to Stand Still</h4>
<p>At first glance, a gene seems like one of biology’s most basic building blocks: a piece of DNA that makes a trait. Yet, for more than a century, scientists and philosophers have repeatedly questioned whether the gene is a clear, stable, or even useful concept. The surprise is not that the gene has been challenged, but that it has endured.</p>
<p>The reason lies in how scientific concepts actually work. They are not fixed definitions carved in stone. Instead, they evolve alongside scientific practices, technologies, and questions. The gene is a prime example of a “concept in flux”: its meaning has shifted many times, adapted to new discoveries, and diversified across fields, while remaining central to biology.</p>
</section>
<section id="from-inherited-traits-to-abstract-factors" class="level4">
<h4 class="anchored" data-anchor-id="from-inherited-traits-to-abstract-factors">From Inherited Traits to Abstract Factors</h4>
<p>The story begins with Gregor Mendel in the 19th century. Mendel did not set out to discover “genes” or laws of heredity. He was studying how traits behave in plant hybrids. His key innovation was methodological: focusing on individual traits, counting large numbers of offspring, and using a symbolic notation to track inheritance patterns.</p>
<p>From this, regularities emerged - dominance, segregation, and independent assortment. Mendel spoke of “elements” or “factors” in reproductive cells, but he did not claim they were universal units of heredity, nor did he know what they were made of. The gene, at this stage, was not a thing but an inferred difference-maker.</p>
<p>Around 1900, Mendel’s work was rediscovered and transformed into Mendelism. These regularities were now treated as general laws of heredity, and the idea took hold that inheritance depended on discrete units passed through gametes. Still, these units were theoretical placeholders, not physical objects.</p>
</section>
<section id="naming-the-gene-without-explaining-it" class="level4">
<h4 class="anchored" data-anchor-id="naming-the-gene-without-explaining-it">Naming the Gene, Without Explaining It</h4>
<p>In 1909, Wilhelm Johannsen introduced the word “gene” precisely to avoid premature assumptions. A gene, he said, was simply “something” in the gametes that makes a difference to traits. He also introduced the crucial distinction between genotype (what is inherited) and phenotype (what develops through interaction with the environment).</p>
<p>This move was paradoxical but powerful. By stripping the gene of speculative meaning, Johannsen made it a workable scientific object. Genes could now be inferred from observable differences without committing to how they functioned or what they were made of.</p>
</section>
<section id="genes-on-chromosomes-not-blueprints" class="level4">
<h4 class="anchored" data-anchor-id="genes-on-chromosomes-not-blueprints">Genes on Chromosomes, Not Blueprints</h4>
<p>Early 20th-century genetics, especially through the work of Thomas Hunt Morgan and his group, linked genes to chromosomes. By studying fruit flies, they showed that genes are arranged linearly, can recombine, and can be mapped relative to one another.</p>
<p>This established the “classical gene” as a material unit located on chromosomes. However, even then, genes were not seen as simple instructions for traits. One gene could affect many traits, and many genes could affect one trait. Genetic causation was about differences, not direct construction. Development remained a complex, interactive process.</p>
</section>
<section id="from-genes-to-molecules" class="level4">
<h4 class="anchored" data-anchor-id="from-genes-to-molecules">From Genes to Molecules</h4>
<p>The mid-20th century brought a major shift: the identification of DNA as the genetic material and the discovery of its double-helix structure. This solved a long-standing puzzle - how genes could copy themselves - and reframed genes as sequences of DNA.</p>
<p>With the cracking of the genetic code, genes came to be understood as templates for proteins. This gave rise to the “classical molecular gene”: a stretch of DNA that is transcribed into RNA and translated into a protein. For a time, biology embraced a clean formula: one gene, one protein.</p>
<p>But this clarity did not last.</p>
</section>
<section id="the-gene-becomes-complicated-again" class="level4">
<h4 class="anchored" data-anchor-id="the-gene-becomes-complicated-again">The Gene Becomes Complicated Again</h4>
<p>Molecular biology soon revealed that genes are not neat, continuous units. In eukaryotes, genes are split into exons and introns; RNA can be spliced in multiple ways; editing, overlapping transcripts, regulatory regions, and non-coding RNAs are pervasive. One DNA region can produce many different products, and one product can draw on multiple genomic regions.</p>
<p>At the same time, gene regulation, development, and evolution revealed that DNA works within dense networks of interactions. Genes respond to cellular contexts; they do not act alone or issue fixed instructions.</p>
</section>
<section id="genomics-and-the-post-genomic-gene" class="level4">
<h4 class="anchored" data-anchor-id="genomics-and-the-post-genomic-gene">Genomics and the Post-Genomic Gene</h4>
<p>The sequencing of whole genomes intensified these challenges. Humans turned out to have far fewer protein-coding genes than expected, and much of the genome is transcribed without coding for proteins. Projects like ENCODE showed that functional genomic elements overlap extensively and defy simple boundaries.</p>
<p>This led to the idea of a “post-genomic gene”: not a single stretch of DNA, but a set of genomic sequences that together give rise to a coherent set of functional products. In this view, genes are defined as much by what they do as by where they are.</p>
</section>
<section id="many-gene-concepts-one-word" class="level4">
<h4 class="anchored" data-anchor-id="many-gene-concepts-one-word">Many Gene Concepts, One Word</h4>
<p>Today, biology uses multiple gene concepts side by side:</p>
<ul>
<li><strong>Instrumental genes</strong>, used to predict inheritance patterns.</li>
<li><strong>Molecular genes</strong>, defined by DNA sequences and products.</li>
<li><strong>Developmental genes</strong>, understood as resources in complex processes.</li>
<li><strong>Post-genomic genes</strong>, seen as distributed and context-dependent.</li>
</ul>
<p>None of these has replaced the others. Instead, the gene remains useful precisely because it is flexible. Its vagueness allows it to connect disciplines, adapt to new technologies, and support different explanatory goals.</p>
</section>
<section id="why-the-gene-persists" class="level4">
<h4 class="anchored" data-anchor-id="why-the-gene-persists">Why the Gene Persists</h4>
<p>The gene has survived not because it is simple, but because it is productive. It evolves with biology itself, absorbing new meanings without collapsing. Rather than being a fixed entity, the gene is a bridge between heredity, development, evolution, and molecular mechanisms.</p>
</section>
</section>
<section id="the-biological-footnote" class="level2">
<h2 class="anchored" data-anchor-id="the-biological-footnote">The BioLogical Footnote</h2>
<blockquote class="blockquote">
<p>Asking “What is a gene?” has no final answer. The gene is not a settled object, but a living concept, reshaped whenever biology learns something new about life.</p>
</blockquote>
</section>
<section id="to-explore-further" class="level2">
<h2 class="anchored" data-anchor-id="to-explore-further">To Explore Further</h2>
<p><a href="https://plato.stanford.edu/entries/gene/">Stanford Encyclopedia of Philosophy</a></p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2026, Isabel Duarte</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/iduarte/iduarte.github.io">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>